# Интерфейс управления гостями

## Описание

Модуль управления гостями позволяет отслеживать проживающих, заселять и выселять клиентов.

## Список гостей

**Путь:** `/guests`

**Компонент:** `GuestsView.vue`

### Функционал

- Таблица всех гостей с пагинацией
- Поиск по ФИО, паспорту, городу
- Фильтр по городу
- Фильтр по статусу (все/проживающие/выехавшие)
- Заселение нового гостя
- Выселение проживающего гостя
- Редактирование и удаление записей

### Колонки таблицы

| Колонка | Описание |
|---------|----------|
| ФИО | Полное имя гостя |
| Паспорт | Номер паспорта |
| Город | Город проживания |
| Номер | Номер комнаты |
| Заселение | Дата заселения |
| Выселение | Дата выселения |
| Статус | Проживает/Выехал |
| Действия | Кнопки управления |

### Фильтры

- **Поиск** — по ФИО, паспорту
- **Город** — текстовый фильтр
- **Статус** — все / проживающие / выехавшие

## Детальная страница гостя

**Путь:** `/guests/:id`

**Компонент:** `GuestDetailView.vue`

### Информация о госте

- ФИО и статус
- Номер паспорта
- Город
- Номер комнаты
- Даты заселения/выселения

### Дополнительные функции

#### Уборка номера

Показывает, кто убирает номер гостя в выбранный день недели.

1. Выберите день недели
2. Нажмите "Показать"
3. Отобразится список служащих

#### Одновременные гости

Показывает гостей, проживавших одновременно с текущим.

## Форма заселения

### Поля

| Поле | Тип | Валидация |
|------|-----|-----------|
| Фамилия | text | Обязательное |
| Имя | text | Обязательное |
| Отчество | text | Необязательное |
| Номер паспорта | text | Обязательное, уникальное |
| Город | text | Обязательное |
| Номер | select | Обязательное |
| Дата заселения | date | Обязательное |

## Диалог выселения

При выселении указывается:
- ФИО гостя (информационно)
- Дата выселения (по умолчанию сегодня)

## API endpoints

### Получение списка

```
GET /api/guests/
GET /api/guests/?search=Иванов
GET /api/guests/?ordering=-check_in_date
```

### Текущие гости

```
GET /api/guests/current/

Response:
{
  "count": 15,
  "guests": [...]
}
```

### Гости из города

```
GET /api/guests/from_city/?city=Москва

Response:
{
  "city": "Москва",
  "count": 5,
  "guests": [...]
}
```

### Заселение

```
POST /api/guests/check_in/
Authorization: Token xxx

{
  "passport_number": "1234 567890",
  "last_name": "Иванов",
  "first_name": "Иван",
  "middle_name": "Иванович",
  "city": "Москва",
  "room": 1,
  "check_in_date": "2024-01-15"
}
```

### Выселение

```
PATCH /api/guests/{id}/check_out/
Authorization: Token xxx

{
  "check_out_date": "2024-01-20"
}
```

### Кто убирает номер

```
GET /api/guests/{id}/cleaning_staff/?weekday=1

Response:
{
  "guest": {...},
  "weekday": 1,
  "cleaning_staff": [
    {
      "id": 1,
      "staff_name": "Петрова Мария",
      "floor": 2
    }
  ]
}
```

### Одновременные гости

```
GET /api/guests/{id}/concurrent_guests/
GET /api/guests/{id}/concurrent_guests/?start_date=2024-01-01&end_date=2024-01-31

Response:
{
  "guest": {...},
  "period": {
    "start": "2024-01-15",
    "end": "2024-01-20"
  },
  "concurrent_guests": [...],
  "count": 8
}
```

## Пример использования

```javascript
import { guestsAPI } from '@/api'

// Заселение гостя
await guestsAPI.checkIn({
  passport_number: '1234 567890',
  last_name: 'Иванов',
  first_name: 'Иван',
  city: 'Москва',
  room: 1,
  check_in_date: '2024-01-15'
})

// Выселение
await guestsAPI.checkOut(guestId, {
  check_out_date: '2024-01-20'
})

// Получение текущих гостей
const current = await guestsAPI.getCurrent()
```
